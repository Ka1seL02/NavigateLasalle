<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Navigation Kiosk</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
    }
    #map {
      position: relative;
      width: 100vw;
      height: 100vh;
      background: url('../img/map_dlsud.png') no-repeat center center;
      background-size: contain;
    }
    .node {
      position: absolute;
      width: 20px;
      height: 20px;
      background-color: red;
      color: white;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }
    #controls {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(255, 255, 255, 0.9);
      padding: 10px;
      border-radius: 8px;
    }
    .path-line {
      position: absolute;
      height: 2px;
      background: yellow;
      z-index: 1;
    }
  </style>
</head>
<body>
  <div id="map">
    <div id="controls">
      <label>From:
        <select id="start">
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
          <option value="D">D</option>
          <option value="E">E</option>
          <option value="F">F</option>
          <option value="G">G</option>
          <option value="H">H</option>
          <option value="I">I</option>
          <option value="J">J</option>
        </select>
      </label>
      <label>To:
        <select id="end">
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
          <option value="D">D</option>
          <option value="E">E</option>
          <option value="F">F</option>
          <option value="G">G</option>
          <option value="H">H</option>
          <option value="I">I</option>
          <option value="J">J</option>
        </select>
      </label>
      <button onclick="calculatePath()">Navigate</button>
    </div>

    <!-- Node Markers -->
    <div class="node" style="left: 1310px; top: 720px">A</div>
    <div class="node" style="left: 100px; top: 660px">B</div>
    <div class="node" style="left: 260px; top: 580px">C</div>
    <div class="node" style="left: 500px; top: 500px">D</div>
    <div class="node" style="left: 690px; top: 290px">E</div>
    <div class="node" style="left: 1160px; top: 280px">F</div>
    <div class="node" style="left: 180px; top: 200px">G</div>
    <div class="node" style="left: 260px; top: 300px">H</div>
    <div class="node" style="left: 850px; top: 130px">I</div>
    <div class="node" style="left: 100px; top: 100px">J</div>
  </div>

  <script>
    const coords = {
      A: { x: 1310, y: 720 },
      B: { x: 100, y: 660 },
      C: { x: 260, y: 580 },
      D: { x: 500, y: 500 },
      E: { x: 690, y: 290 },
      F: { x: 1160, y: 280 },
      G: { x: 180, y: 200 },
      H: { x: 260, y: 300 },
      I: { x: 850, y: 130 },
      J: { x: 100, y: 100 }
    };

    // Example graph: connections and weights (Euclidean distance)
    const graph = {
      A: ['F', 'I'],
      B: ['C'],
      C: ['B', 'D'],
      D: ['C', 'E', 'H'],
      E: ['D', 'F'],
      F: ['E', 'A'],
      G: ['H'],
      H: ['G', 'D'],
      I: ['A'],
      J: ['G']
    };

    function heuristic(a, b) {
      return Math.hypot(coords[a].x - coords[b].x, coords[a].y - coords[b].y);
    }

    function astar(start, goal) {
      let openSet = [start];
      let cameFrom = {};
      let gScore = Object.fromEntries(Object.keys(coords).map(k => [k, Infinity]));
      let fScore = Object.fromEntries(Object.keys(coords).map(k => [k, Infinity]));
      gScore[start] = 0;
      fScore[start] = heuristic(start, goal);

      while (openSet.length > 0) {
        let current = openSet.reduce((a, b) => fScore[a] < fScore[b] ? a : b);
        if (current === goal) {
          let path = [current];
          while (cameFrom[current]) {
            current = cameFrom[current];
            path.push(current);
          }
          return path.reverse();
        }

        openSet = openSet.filter(n => n !== current);
        for (let neighbor of graph[current]) {
          let tentativeG = gScore[current] + heuristic(current, neighbor);
          if (tentativeG < gScore[neighbor]) {
            cameFrom[neighbor] = current;
            gScore[neighbor] = tentativeG;
            fScore[neighbor] = tentativeG + heuristic(neighbor, goal);
            if (!openSet.includes(neighbor)) openSet.push(neighbor);
          }
        }
      }
      return null;
    }

    function drawLine(from, to) {
      const x1 = coords[from].x;
      const y1 = coords[from].y;
      const x2 = coords[to].x;
      const y2 = coords[to].y;

      const length = Math.hypot(x2 - x1, y2 - y1);
      const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI;

      const line = document.createElement('div');
      line.classList.add('path-line');
      line.style.width = length + 'px';
      line.style.left = x1 + 'px';
      line.style.top = y1 + 'px';
      line.style.transform = `rotate(${angle}deg)`;
      document.getElementById('map').appendChild(line);
    }

    function calculatePath() {
      document.querySelectorAll('.path-line').forEach(el => el.remove());

      const start = document.getElementById('start').value;
      const end = document.getElementById('end').value;
      const path = astar(start, end);
      if (!path) {
        alert("No path found");
        return;
      }
      for (let i = 0; i < path.length - 1; i++) {
        drawLine(path[i], path[i + 1]);
      }
    }
  </script>
</body>
</html>